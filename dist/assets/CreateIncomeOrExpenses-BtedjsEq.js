import{b as Pe,s as Y,a as $e}from"./makeHttpReq-4BPij2rk.js";import{u as W,D as M}from"./incomeOrExpense-ohXhgLHV.js";import{g as je}from"./auth-BICLTMCl.js";import{j as x,q as ke,s as Se,v as j,x as U,y as Z,z as Le,A as g,B as ze,C as Ae,k as u,D as ee,E as te,G as ne,d as k,o as R,c as E,e as h,t as L,b as me,F as re,h as Te,n as pe,H as se,I as Ne,a as V,w as z,r as De,f as Fe}from"./index-CMc1aAR8.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./App-BkH2lvXh.js";const B=W();function qe(){const t=x(!1);async function r(n,e,a){var o;try{const f=je(),i=n==M.INCOME?"incomes":"expenses";t.value=!0,B.input.userId=parseInt((o=f==null?void 0:f.user)==null?void 0:o.userId);const d=a?await Me(i,e):await Ge(i,e);B.edit=!1,B.input={},Pe(d.message),t.value=!1}catch(f){if(typeof f.errors<"u")for(const i of f.errors)Y(i);t.value=!1,Y(f.message)}}return{createIncomeOrExpense:r,loading:t}}async function Ge(t,r){return await $e(t,"POST",r)}async function Me(t,r){return await $e(t,"PUT",r)}function ae(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);r&&(e=e.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,e)}return n}function O(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ae(Object(n),!0).forEach(function(e){Ue(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ue(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function oe(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(t).reduce((n,e)=>(r.includes(e)||(n[e]=u(t[e])),n),{})}function A(t){return typeof t=="function"}function He(t){return ze(t)||Ae(t)}function ve(t,r,n){let e=t;const a=r.split(".");for(let o=0;o<a.length;o++){if(!e[a[o]])return n;e=e[a[o]]}return e}function q(t,r,n){return g(()=>t.some(e=>ve(r,e,{[n]:!1})[n]))}function le(t,r,n){return g(()=>t.reduce((e,a)=>{const o=ve(r,a,{[n]:!1})[n]||[];return e.concat(o)},[]))}function he(t,r,n,e){return t.call(e,u(r),u(n),e)}function ge(t){return t.$valid!==void 0?!t.$valid:!t}function We(t,r,n,e,a,o,f){let{$lazy:i,$rewardEarly:d}=a,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],m=arguments.length>8?arguments[8]:void 0,p=arguments.length>9?arguments[9]:void 0,_=arguments.length>10?arguments[10]:void 0;const v=x(!!e.value),s=x(0);n.value=!1;const $=j([r,e].concat(l,_),()=>{if(i&&!e.value||d&&!p.value&&!n.value)return;let c;try{c=he(t,r,m,f)}catch(y){c=Promise.reject(y)}s.value++,n.value=!!s.value,v.value=!1,Promise.resolve(c).then(y=>{s.value--,n.value=!!s.value,o.value=y,v.value=ge(y)}).catch(y=>{s.value--,n.value=!!s.value,o.value=y,v.value=!0})},{immediate:!0,deep:typeof r=="object"});return{$invalid:v,$unwatch:$}}function Ze(t,r,n,e,a,o,f,i){let{$lazy:d,$rewardEarly:l}=e;const m=()=>({}),p=g(()=>{if(d&&!n.value||l&&!i.value)return!1;let _=!0;try{const v=he(t,r,f,o);a.value=v,_=ge(v)}catch(v){a.value=v}return _});return{$unwatch:m,$invalid:p}}function Xe(t,r,n,e,a,o,f,i,d,l,m){const p=x(!1),_=t.$params||{},v=x(null);let s,$;t.$async?{$invalid:s,$unwatch:$}=We(t.$validator,r,p,n,e,v,a,t.$watchTargets,d,l,m):{$invalid:s,$unwatch:$}=Ze(t.$validator,r,n,e,v,a,d,l);const c=t.$message;return{$message:A(c)?g(()=>c(oe({$pending:p,$invalid:s,$params:oe(_),$model:r,$response:v,$validator:o,$propertyPath:i,$property:f}))):c||"",$params:_,$pending:p,$invalid:s,$response:v,$unwatch:$}}function Je(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=u(t),n=Object.keys(r),e={},a={},o={};let f=null;return n.forEach(i=>{const d=r[i];switch(!0){case A(d.$validator):e[i]=d;break;case A(d):e[i]={$validator:d};break;case i==="$validationGroups":f=d;break;case i.startsWith("$"):o[i]=d;break;default:a[i]=d}}),{rules:e,nestedValidators:a,config:o,validationGroups:f}}const Ke="__root";function Qe(t,r,n,e,a,o,f,i,d){const l=Object.keys(t),m=e.get(a,t),p=x(!1),_=x(!1),v=x(0);if(m){if(!m.$partial)return m;m.$unwatch(),p.value=m.$dirty.value}const s={$dirty:p,$path:a,$touch:()=>{p.value||(p.value=!0)},$reset:()=>{p.value&&(p.value=!1)},$commit:()=>{}};return l.length?(l.forEach($=>{s[$]=Xe(t[$],r,s.$dirty,o,f,$,n,a,d,_,v)}),s.$externalResults=g(()=>i.value?[].concat(i.value).map(($,c)=>({$propertyPath:a,$property:n,$validator:"$externalResults",$uid:`${a}-externalResult-${c}`,$message:$,$params:{},$response:null,$pending:!1})):[]),s.$invalid=g(()=>{const $=l.some(c=>u(s[c].$invalid));return _.value=$,!!s.$externalResults.value.length||$}),s.$pending=g(()=>l.some($=>u(s[$].$pending))),s.$error=g(()=>s.$dirty.value?s.$pending.value||s.$invalid.value:!1),s.$silentErrors=g(()=>l.filter($=>u(s[$].$invalid)).map($=>{const c=s[$];return Z({$propertyPath:a,$property:n,$validator:$,$uid:`${a}-${$}`,$message:c.$message,$params:c.$params,$response:c.$response,$pending:c.$pending})}).concat(s.$externalResults.value)),s.$errors=g(()=>s.$dirty.value?s.$silentErrors.value:[]),s.$unwatch=()=>l.forEach($=>{s[$].$unwatch()}),s.$commit=()=>{_.value=!0,v.value=Date.now()},e.set(a,t,s),s):(m&&e.set(a,t,s),s)}function Ye(t,r,n,e,a,o,f){const i=Object.keys(t);return i.length?i.reduce((d,l)=>(d[l]=H({validations:t[l],state:r,key:l,parentKey:n,resultsCache:e,globalConfig:a,instance:o,externalResults:f}),d),{}):{}}function et(t,r,n){const e=g(()=>[r,n].filter(s=>s).reduce((s,$)=>s.concat(Object.values(u($))),[])),a=g({get(){return t.$dirty.value||(e.value.length?e.value.every(s=>s.$dirty):!1)},set(s){t.$dirty.value=s}}),o=g(()=>{const s=u(t.$silentErrors)||[],$=e.value.filter(c=>(u(c).$silentErrors||[]).length).reduce((c,y)=>c.concat(...y.$silentErrors),[]);return s.concat($)}),f=g(()=>{const s=u(t.$errors)||[],$=e.value.filter(c=>(u(c).$errors||[]).length).reduce((c,y)=>c.concat(...y.$errors),[]);return s.concat($)}),i=g(()=>e.value.some(s=>s.$invalid)||u(t.$invalid)||!1),d=g(()=>e.value.some(s=>u(s.$pending))||u(t.$pending)||!1),l=g(()=>e.value.some(s=>s.$dirty)||e.value.some(s=>s.$anyDirty)||a.value),m=g(()=>a.value?d.value||i.value:!1),p=()=>{t.$touch(),e.value.forEach(s=>{s.$touch()})},_=()=>{t.$commit(),e.value.forEach(s=>{s.$commit()})},v=()=>{t.$reset(),e.value.forEach(s=>{s.$reset()})};return e.value.length&&e.value.every(s=>s.$dirty)&&p(),{$dirty:a,$errors:f,$invalid:i,$anyDirty:l,$error:m,$pending:d,$touch:p,$reset:v,$silentErrors:o,$commit:_}}function H(t){let{validations:r,state:n,key:e,parentKey:a,childResults:o,resultsCache:f,globalConfig:i={},instance:d,externalResults:l}=t;const m=a?`${a}.${e}`:e,{rules:p,nestedValidators:_,config:v,validationGroups:s}=Je(r),$=O(O({},i),v),c=e?g(()=>{const b=u(n);return b?u(b[e]):void 0}):n,y=O({},u(l)||{}),X=g(()=>{const b=u(l);return e?b?u(b[e]):void 0:b}),J=Qe(p,c,e,f,m,$,d,X,n),C=Ye(_,c,m,f,$,d,X),K={};s&&Object.entries(s).forEach(b=>{let[I,w]=b;K[I]={$invalid:q(w,C,"$invalid"),$error:q(w,C,"$error"),$pending:q(w,C,"$pending"),$errors:le(w,C,"$errors"),$silentErrors:le(w,C,"$silentErrors")}});const{$dirty:T,$errors:be,$invalid:N,$anyDirty:xe,$error:Re,$pending:D,$touch:F,$reset:Ee,$silentErrors:we,$commit:Q}=et(J,C,o),Oe=e?g({get:()=>u(c),set:b=>{T.value=!0;const I=u(n),w=u(l);w&&(w[e]=y[e]),U(I[e])?I[e].value=b:I[e]=b}}):null;e&&$.$autoDirty&&j(c,()=>{T.value||F();const b=u(l);b&&(b[e]=y[e])},{flush:"sync"});async function Ce(){return F(),$.$rewardEarly&&(Q(),await ne()),await ne(),new Promise(b=>{if(!D.value)return b(!N.value);const I=j(D,()=>{b(!N.value),I()})})}function Ie(b){return(o.value||{})[b]}function Ve(){U(l)?l.value=y:Object.keys(y).length===0?Object.keys(l).forEach(b=>{delete l[b]}):Object.assign(l,y)}return Z(O(O(O({},J),{},{$model:Oe,$dirty:T,$error:Re,$errors:be,$invalid:N,$anyDirty:xe,$pending:D,$touch:F,$reset:Ee,$path:m||Ke,$silentErrors:we,$validate:Ce,$commit:Q},o&&{$getResultsForChild:Ie,$clearExternalResults:Ve,$validationGroups:K}),C))}class tt{constructor(){this.storage=new Map}set(r,n,e){this.storage.set(r,{rules:n,result:e})}checkRulesValidity(r,n,e){const a=Object.keys(e),o=Object.keys(n);return o.length!==a.length||!o.every(i=>a.includes(i))?!1:o.every(i=>n[i].$params?Object.keys(n[i].$params).every(d=>u(e[i].$params[d])===u(n[i].$params[d])):!0)}get(r,n){const e=this.storage.get(r);if(!e)return;const{rules:a,result:o}=e,f=this.checkRulesValidity(r,n,a),i=o.$unwatch?o.$unwatch:()=>({});return f?o:{$dirty:o.$dirty,$partial:!0,$unwatch:i}}}const S={COLLECT_ALL:!0,COLLECT_NONE:!1},ie=Symbol("vuelidate#injectChildResults"),ue=Symbol("vuelidate#removeChildResults");function nt(t){let{$scope:r,instance:n}=t;const e={},a=x([]),o=g(()=>a.value.reduce((m,p)=>(m[p]=u(e[p]),m),{}));function f(m,p){let{$registerAs:_,$scope:v,$stopPropagation:s}=p;s||r===S.COLLECT_NONE||v===S.COLLECT_NONE||r!==S.COLLECT_ALL&&r!==v||(e[_]=m,a.value.push(_))}n.__vuelidateInjectInstances=[].concat(n.__vuelidateInjectInstances||[],f);function i(m){a.value=a.value.filter(p=>p!==m),delete e[m]}n.__vuelidateRemoveInstances=[].concat(n.__vuelidateRemoveInstances||[],i);const d=ee(ie,[]);te(ie,n.__vuelidateInjectInstances);const l=ee(ue,[]);return te(ue,n.__vuelidateRemoveInstances),{childResults:o,sendValidationResultsToParent:d,removeValidationResultsFromParent:l}}function _e(t){return new Proxy(t,{get(r,n){return typeof r[n]=="object"?_e(r[n]):g(()=>r[n])}})}let ce=0;function rt(t,r){var n;let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(e=t,t=void 0,r=void 0);let{$registerAs:a,$scope:o=S.COLLECT_ALL,$stopPropagation:f,$externalResults:i,currentVueInstance:d}=e;const l=d||((n=ke())===null||n===void 0?void 0:n.proxy),m=l?l.$options:{};a||(ce+=1,a=`_vuelidate_${ce}`);const p=x({}),_=new tt,{childResults:v,sendValidationResultsToParent:s,removeValidationResultsFromParent:$}=l?nt({$scope:o,instance:l}):{childResults:x({})};if(!t&&m.validations){const c=m.validations;r=x({}),Se(()=>{r.value=l,j(()=>A(c)?c.call(r.value,new _e(r.value)):c,y=>{p.value=H({validations:y,state:r,childResults:v,resultsCache:_,globalConfig:e,instance:l,externalResults:i||l.vuelidateExternalResults})},{immediate:!0})}),e=m.validationsConfig||e}else{const c=U(t)||He(t)?t:Z(t||{});j(c,y=>{p.value=H({validations:y,state:r,childResults:v,resultsCache:_,globalConfig:e,instance:l??{},externalResults:i})},{immediate:!0})}return l&&(s.forEach(c=>c(p,{$registerAs:a,$scope:o,$stopPropagation:f})),Le(()=>$.forEach(c=>c(a)))),g(()=>O(O({},u(p.value)),v.value))}const st={for:""},at={class:"error-msg"},ot=k({__name:"Error",props:{label:{},errors:{}},setup(t){const r=t;return(n,e)=>(R(),E(re,null,[h("label",st,L(r.label),1),h("div",{class:pe({error:r.errors.length})},[me(n.$slots,"default",{},void 0,!0),(R(!0),E(re,null,Te(r.errors,a=>(R(),E("div",{class:"input-errors",key:a.$uid},[h("div",at,L(a.$message),1)]))),128))],2)],64))}}),de=Be(ot,[["__scopeId","data-v-e82c9f34"]]),lt=["value","type"],fe=k({__name:"BaseInput",props:{type:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:r}){const n=r;function e(a){const o=a.target.value;n("update:modelValue",o)}return(a,o)=>(R(),E("input",{value:a.modelValue,type:typeof a.type>"u"?"text":a.type,class:"form-control",onInput:e,placeholder:""},null,40,lt))}}),it=["disabled"],ut={key:0},ct={key:1,class:"d-flex justify-content-center"},dt=h("div",{class:"spinner-border",role:"status"},[h("span",{class:"visually-hidden"},"Loading... ")],-1),ft=[dt],$t=k({__name:"BaseBtn",props:{loading:{type:Boolean},label:{}},setup(t){return(r,n)=>(R(),E("button",{disabled:r.loading,class:"btn btn-primary w-100"},[r.loading?se("",!0):(R(),E("span",ut,L(r.label),1)),r.loading?(R(),E("div",ct,ft)):se("",!0)],8,it))}}),ye=t=>{if(t=u(t),Array.isArray(t))return!!t.length;if(t==null)return!1;if(t===!1)return!0;if(t instanceof Date)return!isNaN(t.getTime());if(typeof t=="object"){for(let r in t)return!0;return!1}return!!String(t).length};function P(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e=>(e=u(e),!ye(e)||r.every(a=>(a.lastIndex=0,a.test(e))))}P(/^[a-zA-Z]*$/);P(/^[a-zA-Z0-9]*$/);P(/^\d*(\.\d+)?$/);const mt=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;P(mt);function pt(t){return typeof t=="string"&&(t=t.trim()),ye(t)}var G={$validator:pt,$message:"Value is required",$params:{type:"required"}};const vt=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;P(vt);P(/(^[0-9]*$)|(^-[0-9]+$)/);var ht=P(/^[-]?\d*(\.\d+)?$/),gt={$validator:ht,$message:"Value must be decimal",$params:{type:"decimal"}};const _t={class:"container"},yt={class:"row"},bt={class:"col-md-6"},xt={class:"card"},Rt=h("div",{class:"card-header"},[h("b",null,"Create an Expense or Income")],-1),Et={class:"card-body"},wt=h("br",null,null,-1),Ot={class:"row"},Ct={class:"col-md-3"},It={class:"form-group"},Vt=["checked"],Pt=h("br",null,null,-1),jt={class:"row"},kt={class:"row"},St=h("div",{class:"col-md-8"},null,-1),Lt={class:"col-md-4"},zt=k({__name:"CreateIncomeOrExpenseForm",props:{loading:{type:Boolean}},emits:["submitForm"],setup(t,{emit:r}){const n={name:{required:G},amount:{required:G,decimal:gt},userId:{required:G}},e=W();function a(){e.checkboxInput.val=!e.checkboxInput.val,e.checkboxInput.val?e.checkboxInput.label=M.INCOME:e.checkboxInput.label=M.EXPENSE}const o=rt(n,e.input),f=r;async function i(){await o.value.$validate()&&(await f("submitForm",e.input,e.checkboxInput.label),o.value.$reset())}return(d,l)=>(R(),E("div",_t,[h("div",yt,[h("div",bt,[h("div",xt,[Rt,h("div",Et,[h("form",{onSubmit:Ne(i,["prevent"])},[V(de,{label:"Name",errors:u(o).name.$errors},{default:z(()=>[V(fe,{"tested-input":"name",modelValue:u(e).input.name,"onUpdate:modelValue":l[0]||(l[0]=m=>u(e).input.name=m)},null,8,["modelValue"])]),_:1},8,["errors"]),V(de,{label:"Amount",errors:u(o).amount.$errors},{default:z(()=>[V(fe,{"tested-input":"amount",modelValue:u(e).input.amount,"onUpdate:modelValue":l[1]||(l[1]=m=>u(e).input.amount=m)},null,8,["modelValue"])]),_:1},8,["errors"]),wt,h("div",Ot,[h("div",Ct,[h("div",It,[h("label",null,L(u(e).checkboxInput.label),1),h("input",{type:"checkbox",onClick:a,style:{transform:"scale(1.3)"},checked:u(e).checkboxInput.val},null,8,Vt)])])]),Pt,h("div",jt,[me(d.$slots,"link")]),h("div",kt,[St,h("div",Lt,[V($t,{class:pe(u(e).edit?"btn btn-warning":"btn btn-primary"),loading:d.loading,label:u(e).edit?"Update":"Create"},null,8,["class","loading","label"])])])],32)])])])])]))}}),At={class:"container"},Tt=h("div",{class:"row"},null,-1),Nt={class:"row"},Dt={class:"col-md-10"},Ht=k({__name:"CreateIncomeOrExpenses",setup(t){const{loading:r,createIncomeOrExpense:n}=qe(),{edit:e}=W();async function a(o,f){await n(f,o,e)}return(o,f)=>{const i=De("RouterLink");return R(),E("div",At,[Tt,h("div",Nt,[h("div",Dt,[V(zt,{loading:u(r),onSubmitForm:a},{link:z(()=>[V(i,{to:"/income_and_expenses"},{default:z(()=>[Fe("Income & Expenses")]),_:1})]),_:1},8,["loading"])])])])}}});export{Ht as default};
